<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="theme-color" content="rgb(200,205,255)">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<style>
  body{
    margin:0;
    padding:0;
    }
  #addC{
    margin: 23px;
    position: absolute;
    bottom:0;
    right:0;
    padding:10px;
    border-radius:50%;
    background: transparent;
    }
  .cont{
    width: 100vw;
    overflow:hidden;
    background-color:#000;
    display: flex;
    justify-content: center;
    align-items:center;
    }
  .
  </style>
</head>

<div id="body"></div>
<button id='addC' onclick='window.open("/upload.html","_self")'>add</button>
<script type="module">

  // Import the functions you need from the SDKs you need

  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-app.js";

  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-analytics.js";

  // TODO: Add SDKs for Firebase products that you want to use

  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration

  // For Firebase JS SDK v7.20.0 and later, measurementId is optional

  const firebaseConfig = {

    apiKey: "AIzaSyAN-X9u7n7QnM8RLrVV4YnXq2MmVz6WNfw",

    authDomain: "em-issyoo.firebaseapp.com",

    projectId: "em-issyoo",

    storageBucket: "em-issyoo.appspot.com",

    messagingSenderId: "33480809995",

    appId: "1:33480809995:web:74df1e056f7638d0b5310e",

    measurementId: "G-C64NWHRT0Y"

  };

  // Initialize Firebase

  

  import{

      getFirestore,Timestamp , doc, getDoc, getDocs, limit, orderBy, query, where, setDoc, collection, addDoc, updateDoc, deleteDoc, deleteField, onSnapshot, arrayUnion

  }from "https://www.gstatic.com/firebasejs/9.9.3/firebase-firestore.js";

  import { getAuth, signInWithPopup,signInWithEmailAndPassword, createUserWithEmailAndPassword, GoogleAuthProvider , signOut

  } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-auth.js";

import { getStorage, ref as sRef, uploadBytesResumable , getDownloadURL

  } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-storage.js";

   const app = initializeApp(firebaseConfig);

  const analytics = getAnalytics(app);

  const auth = getAuth();

  const db = getFirestore();

   const storage = getStorage();

   var attch;

   

   

   

   async function newData(){

var uid = sessionStorage.getItem('uid');


  const q = query(collection(db, "Public"), where("Uid", "==", uid));

const querySnapshot = await getDocs(q);

querySnapshot.forEach((doc) => {

    

        console.log("New msg: "+ doc.data());

var div = document.createElement('div');
      var cont = document.createElement('div');
      cont.appendChild(div);

 document.getElementById("body").appendChild(cont);

 console.log("Document data:", doc.data());

  if(!!doc.data().FileTyp){ var ffl = doc.data().FileTyp;}

  else{ffl = 'iframe';}

  let ifrm = document.createElement(ffl);

  ifrm.style.maxWidth = "45vw";

             ifrm.setAttribute("src", doc.data().Url);
             div.setAttribute('id', 'isknt=' + doc.id);
             ifrm.controls = false;
             div.onclick = openCont;
             div.appendChild(ifrm);
             var title = document.createElement('p');
             title.innerHTML = doc.data().Title;
             cont.appendChild(title);
             var del = document.createElement('button');

             del.innerHTML = 'delete';
             del.onclick = deletC;
             cont.appendChild(del);
  del.setAttribute('id', doc.id);
  div.setAttribute('class', 'cont');
      
      

      

    

  });



}

  



newData();


 function openCont(){
     window.open('/' + this.id , '_self');
     }
async function deletC(){
  await deleteDoc(doc(db, "Public", this.id));
this.parentElement.remove();
  }
</script>
<script>
var uid = sessionStorage.getItem('uid');
if(uid){
     console.log(uid);
    }
  else{ 
    window.open("/signin", "_self")}
</script>
